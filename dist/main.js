(()=>{"use strict";const e="558e6998c7d958821a0225b854f5e43b";function t(e,t){return new Date(e+1e3*(t+14400))}function o(e){return e.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"})}class n{static async loadPage(r,c=""){try{const n=await async function(n,r=""){try{const r=await async function(t,o=""){try{const n=await fetch(`http://api.openweathermap.org/geo/1.0/direct?q=${t},${o}&limit=1&appid=${e}`),r=await n.json();return{longitude:r[0].lon,latitude:r[0].lat,name:r[0].name}}catch(e){return}}(n,""),c=r.longitude,a=r.latitude,s=r.name,i=await async function(t,o){const n=await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${o}&lon=${t}&appid=${e}`);return await n.json()}(c,a),l=await async function(t,o){const n=await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${o}&lon=${t}&exclude=&appid=${e}`);return await n.json()}(c,a),u=function(e,n){const r=t((new Date).getTime(),e.timezone);return{city:n,country:new Intl.DisplayNames(["en"],{type:"region"}).of(e.sys.country),weatherDesc:e.weather[0].description,currDate:r.toDateString(),currTime:o(r),currTemp:(e.main.temp-273.15).toFixed(1),wind:(3.6*e.wind.speed).toFixed(1),feels_like:(e.main.feels_like-273.15).toFixed(1),sunrise:o(t(1e3*e.sys.sunrise,e.timezone)),sunset:o(t(1e3*e.sys.sunset,e.timezone)),icon:`./imgs/weather-icons/${e.weather[0].icon}.svg`}}(i,s);return{todayMain:u,hourlyData:function(e){const o=e.hourly.slice(0,25),n=[];return o.forEach((o=>{n.push({time:t(1e3*o.dt,e.timezone_offset).toLocaleTimeString("en-US",{hour:"numeric"}),icon:`./imgs/weather-icons/${o.weather[0].icon}.svg`,temp:(o.temp-273.15).toFixed(1)})})),n}(l),dailyData:function(e){const o=e.daily.slice(1),n=[];return o.forEach((o=>{n.push({day:t(1e3*o.dt,e.timezone_offset).toLocaleDateString("en-US",{weekday:"long"}),icon:`./imgs/weather-icons/${o.weather[0].icon}.svg`,tempMin:(o.temp.min-273.15).toFixed(),tempMax:(o.temp.max-273.15).toFixed()})})),n}(l)}}catch(e){return}}(r,c);this.clearInputs(),this.loadMainInfo(n.todayMain),this.loadHourlyForecast(n.hourlyData),this.loadDailyForecast(n.dailyData),this.initButtons()}catch(e){n.showError()}}static loadMainInfo(e){document.querySelector("#today-img").src=e.icon,document.querySelector("#location").textContent=`${e.city}, ${e.country}`,document.querySelector("#weather-type").textContent=e.weatherDesc,document.querySelector("#curr-date").textContent=e.currDate,document.querySelector("#curr-time").textContent=e.currTime,document.querySelector("#today-temp").textContent=e.currTemp+"°",document.querySelector("#wind-speed").textContent=e.wind+"km/h",document.querySelector("#feels-like").textContent=e.feels_like+"°",document.querySelector("#sunrise").textContent=e.sunrise,document.querySelector("#sunset").textContent=e.sunset}static loadHourlyForecast(e){const t=document.querySelector(".forecast-hourly");t.textContent="",e.forEach((e=>{t.appendChild(this.createHourlyForecastEntry(e))}))}static loadDailyForecast(e){const t=document.querySelector(".forecast-daily");t.textContent="",e.forEach((e=>{t.appendChild(this.createDailyForecastEntry(e))}))}static initButtons(){const e=document.querySelector(".forecast-hourly"),t=document.querySelector(".forecast-daily");e.addEventListener("wheel",(t=>{t.preventDefault(),e.scrollLeft+=t.deltaY})),t.addEventListener("wheel",(e=>{e.preventDefault(),t.scrollLeft+=e.deltaY})),document.querySelectorAll(".option-select").forEach((e=>{e.addEventListener("click",this.switchForecastMode)})),document.querySelector(".search-box").onsubmit=this.validateSearch}static createHourlyForecastEntry(e){const t=document.createElement("div");return t.classList.add("forecast-entry"),t.innerHTML=`\n        <p class='time'>${e.time}</p>\n        <img src='${e.icon}' class='forecast-img'>\n        <p class='forecast-temp'>${e.temp}°</p>\n        `,t}static createDailyForecastEntry(e){const t=document.createElement("div");return t.classList.add("forecast-entry"),t.innerHTML=`\n        <p class='time'>${e.day}</p>\n        <img src='${e.icon}' class='forecast-img'>\n        <p class='forecast-temp'>${e.tempMax}°</p>\n        <p class='forecast-low'>${e.tempMin}°</p>\n        `,t}static switchForecastMode(e){e.target.classList.contains("selected")||(document.querySelector(".forecast-daily").classList.toggle("active"),document.querySelector(".forecast-hourly").classList.toggle("active"),document.querySelector("#hour-select").classList.toggle("selected"),document.querySelector("#daily-select").classList.toggle("selected"))}static async validateSearch(e){e.preventDefault();const t=document.querySelector("#location-search").value;let o,r=t;t.includes(",")?(r=t.split(",")[0],o=t.split(",")[1]):o="",n.loadPage(r,o)}static clearInputs(){document.querySelector(".error").textContent="",document.querySelector(".search-box").reset()}static showError(){document.querySelector(".error").innerHTML='Location not found.<br>Search must be in the form: "City", "City, State", or "City, Country"'}}n.loadPage("Toronto")})();